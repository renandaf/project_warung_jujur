import {
  Fragment,
  Transition,
  computed,
  createApp,
  createBaseVNode,
  createCommentVNode,
  createElementBlock,
  createVNode,
  defineComponent,
  inject,
  onUpdated,
  openBlock,
  reactive,
  renderList,
  renderSlot,
  toDisplayString,
  unref,
  withCtx,
  withKeys,
  withModifiers
} from "./chunk-G4DFXOZZ.js";
import "./chunk-FAW2VN4A.js";

// node_modules/vue-silentbox/dist/silent-box.es.js
var O = (o) => {
  const e = /^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/.exec(o);
  return e != null && e[7] !== void 0 ? e[7] : "";
};
var Y = (o) => {
  const e = /(vimeo(pro)?\.com)\/(?:[^\d]+)?(\d+)\??(.*)?$/.exec(o);
  return e ? e[3] : "";
};
var J = (o) => {
  const e = /(?:player\.twitch\.tv\/\?channel=|twitch\.tv\/)([a-zA-Z0-9_]+)/.exec(o);
  return e ? e[1] : "";
};
var Z = (o) => {
  if (M(o))
    try {
      const s = new XMLHttpRequest();
      return s.open("GET", o, false), s.send(null), JSON.parse(s.responseText);
    } catch (s) {
      return console.log(s), null;
    }
  throw new Error("Given string: url is not valid URL address.");
};
var D = (o) => [
  "youtube.com",
  "youtu.be",
  "vimeo.com",
  "twitch.tv"
].some((e) => o.includes(e));
var Q = (o) => [
  ".mp4",
  ".ogg",
  ".webm",
  ".mov",
  ".flv",
  ".wmv",
  ".mkv"
].some((e) => o.toLowerCase().includes(e));
var ee = (o, s = "") => {
  var e;
  if (/(youtu\.?be)/.test(o)) {
    const i = O(o);
    return `${location.protocol}//img.youtube.com/vi/${i}/hqdefault.jpg`;
  } else if (/(vimeo(pro)?\.com)/.test(o)) {
    const i = Y(o), c = Z(`${location.protocol}//vimeo.com/api/v2/video/${i}.json`);
    return c && c.length > 0 ? (e = c[0]) == null ? void 0 : e.thumbnail_medium : s;
  } else {
    if (M(o))
      return o;
    throw new Error("Given string: src is not valid URL address.");
  }
};
var M = (o) => new RegExp(
  "^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$",
  "i"
).test(o);
var te = createBaseVNode("div", { id: "silentbox-overlay__background" }, null, -1);
var oe = ["onClick"];
var ne = { id: "silentbox-overlay__embed" };
var ie = ["allow", "src"];
var le = {
  key: 1,
  class: "silentbox-video__frame"
};
var se = ["src", "autoplay", "controls"];
var re = ["srcset", "src", "alt"];
var ae = {
  key: 1,
  id: "silentbox-overlay__tool-buttons"
};
var ce = ["href"];
var de = ["onClick", "onKeyup"];
var ue = createBaseVNode("div", { class: "icon" }, null, -1);
var me = [
  ue
];
var pe = {
  key: 0,
  id: "silentbox-overlay__arrow-buttons"
};
var ve = ["onClick", "onKeyup"];
var be = ["onClick", "onKeyup"];
var N = defineComponent({
  __name: "SilentBoxOverlay",
  props: {
    item: null,
    visible: { type: Boolean },
    currentItem: null,
    totalItems: null
  },
  emits: [
    "silentbox-internal-close-overlay",
    "silentbox-internal-get-next-item",
    "silentbox-internal-get-prev-item",
    "silentbox-overlay-opened",
    "silentbox-overlay-hidden"
  ],
  setup(o, { emit: s }) {
    const e = o, i = inject("silent-box-options") || { downloadButtonLabel: "Download" }, c = computed(() => typeof e.item.download == "string" ? e.item.download : e.item.src), n = (l) => {
      let r = "";
      const a = O(l);
      return a && (r = `${location.protocol}//www.youtube.com/embed/${a}?rel=0`, e.item.autoplay && (r += "&autoplay=1"), e.item.controls || (r += "&controls=0")), r;
    }, $ = (l) => {
      let r = "";
      const a = Y(l);
      return a && (r = `${location.protocol}//player.vimeo.com/video/${a}?rel=0`, e.item.autoplay && (r += "&autoplay=1")), r;
    }, w = (l) => {
      let r = "";
      const a = J(l);
      return a && (r = `${location.protocol}//player.twitch.tv/?channel=${a}&parent=${location.hostname}`, e.item.autoplay && (r += "&autoplay=true")), r;
    }, g = (l) => /(youtu\.?be)/.test(l) ? n(l) : /(vimeo(pro)?\.com)/.test(l) ? $(l) : /(?:player\.|clips\.|www\.)?twitch\.tv/.test(l) ? w(l) : l, E = () => {
      document.body.classList.contains("silentbox-is-opened") || document.body.classList.add("silentbox-is-opened");
    }, b = () => {
      document.body.classList.contains("silentbox-is-opened") && document.body.classList.remove("silentbox-is-opened");
    }, y = reactive({
      name: "silentbox-animation__swipe-left"
    }), h = () => {
      s("silentbox-internal-close-overlay");
    }, x = () => {
      y.name = "silentbox-animation__swipe-left", s("silentbox-internal-get-next-item");
    }, _ = () => {
      y.name = "silentbox-animation__swipe-right", s("silentbox-internal-get-prev-item");
    }, t = reactive({
      posX: 0,
      posY: 0
    }), I = (l) => {
      const { clientX: r, clientY: a } = l.touches[0];
      t.posX = r, t.posY = a;
    }, m = (l) => {
      const { clientX: r, clientY: a } = l.touches[0], { posX: R, posY: B } = t;
      if (R === 0 || B === 0)
        return;
      const T = R - r, P = B - a;
      Math.abs(T) > Math.abs(P) && (T > 0 ? x() : _()), t.posX = 0, t.posY = 0;
    }, k = (l) => {
      l.code === "Escape" && h(), l.code === "ArrowRight" && x(), l.code === "ArrowLeft" && _();
    };
    return onUpdated(() => {
      e.visible ? (window.addEventListener("keyup", k), E()) : (window.removeEventListener("keyup", k), b());
    }), (l, r) => e.visible ? (openBlock(), createElementBlock("div", {
      key: 0,
      id: "silentbox-overlay",
      role: "overlay",
      onTouchstart: I,
      onTouchmove: m
    }, [
      te,
      createVNode(Transition, {
        name: y.name,
        mode: "out-in"
      }, {
        default: withCtx(() => [
          (openBlock(), createElementBlock("div", {
            id: "silentbox-overlay__content",
            onClick: withModifiers(h, ["stop"]),
            key: e.item.src
          }, [
            createBaseVNode("div", ne, [
              createBaseVNode("div", {
                id: "silentbox-overlay__container",
                onClick: r[0] || (r[0] = withModifiers(() => {
                }, ["stop"]))
              }, [
                unref(D)(e.item.src) ? (openBlock(), createElementBlock("iframe", {
                  key: 0,
                  allow: `accelerometer; ${!!e.item.autoplay && "autoplay;"} encrypted-media; gyroscope; picture-in-picture`,
                  src: g(e.item.src),
                  frameborder: "0",
                  width: "100%",
                  height: "100%",
                  allowfullscreen: ""
                }, null, 8, ie)) : unref(Q)(e.item.src) ? (openBlock(), createElementBlock("div", le, [
                  createBaseVNode("video", {
                    src: e.item.src,
                    autoplay: !!e.item.autoplay,
                    controls: e.item.controls,
                    class: "silentbox-video__embed"
                  }, null, 8, se)
                ])) : (openBlock(), createElementBlock("img", {
                  key: 2,
                  srcset: e.item.srcSet ? e.item.srcSet.join(",") : e.item.src,
                  src: e.item.src,
                  alt: e.item.alt
                }, null, 8, re))
              ]),
              e.item.description ? (openBlock(), createElementBlock("p", {
                key: 0,
                id: "silentbox-overlay__description",
                onClick: r[1] || (r[1] = withModifiers(() => {
                }, ["prevent", "stop"]))
              }, toDisplayString(e.item.description), 1)) : createCommentVNode("", true),
              e.item.download ? (openBlock(), createElementBlock("div", ae, [
                createBaseVNode("a", {
                  href: unref(c),
                  class: "download",
                  download: ""
                }, toDisplayString(unref(i).downloadButtonLabel), 9, ce)
              ])) : createCommentVNode("", true)
            ])
          ], 8, oe))
        ]),
        _: 1
      }, 8, ["name"]),
      createBaseVNode("button", {
        id: "silentbox-overlay__close-button",
        role: "button",
        tabindex: "3",
        onClick: withModifiers(h, ["prevent"]),
        onKeyup: withKeys(h, ["enter"])
      }, me, 40, de),
      e.totalItems > 1 ? (openBlock(), createElementBlock("div", pe, [
        createBaseVNode("button", {
          class: "arrow arrow-previous",
          role: "button",
          tabindex: "2",
          onClick: withModifiers(_, ["stop"]),
          onKeyup: withKeys(_, ["enter"])
        }, null, 40, ve),
        createBaseVNode("button", {
          class: "arrow arrow-next",
          role: "button",
          tabindex: "1",
          onClick: withModifiers(x, ["stop"]),
          onKeyup: withKeys(x, ["enter"])
        }, null, 40, be)
      ])) : createCommentVNode("", true)
    ], 32)) : createCommentVNode("", true);
  }
});
var ye = ["href", "onClick"];
var he = ["loading", "src", "alt", "width", "height"];
var xe = defineComponent({
  __name: "SilentBoxGallery",
  props: {
    lazyLoading: { type: Boolean },
    previewCount: null,
    fallbackThumbnail: null,
    gallery: null,
    image: null
  },
  emits: [
    "silentbox-overlay-opened",
    "silentbox-overlay-hidden",
    "silentbox-overlay-next-item-displayed",
    "silentbox-overlay-prev-item-displayed"
  ],
  setup(o, { expose: s, emit: e }) {
    const i = o, c = computed(() => i.gallery ? i.gallery.length : 1), n = reactive({
      item: {
        src: "",
        alt: "",
        thumbnailWidth: 150,
        thumbnailHeight: 0,
        thumbnail: "",
        autoplay: false,
        controls: true,
        description: "",
        download: false
      },
      visible: false,
      currentItem: 0,
      totalItems: c
    }), $ = (t) => D(t) ? ee(t, i.fallbackThumbnail) : t, w = (t) => ({
      ...n.item,
      download: false,
      ...t,
      thumbnail: t.thumbnail ? t.thumbnail : $(t.src)
    }), g = () => i.gallery && i.gallery.length > 0 ? i.gallery.map(w) : i.image ? [w(i.image)] : [], E = computed(() => i.previewCount && i.previewCount > 0 && i.gallery ? i.gallery.slice(0, i.previewCount).map(w) : g()), b = computed(() => g()), y = (t, I = 0) => {
      n.visible = true, n.item = t, n.currentItem = I, e("silentbox-overlay-opened", t);
    }, h = () => {
      n.visible = false, e("silentbox-overlay-hidden", n.item);
    }, x = () => {
      let t = n.currentItem + 1;
      t = t <= b.value.length - 1 ? t : 0, n.item = b.value[t], n.currentItem = t, e("silentbox-overlay-next-item-displayed", n.item);
    }, _ = () => {
      let t = n.currentItem - 1;
      t = t >= 0 ? t : b.value.length - 1, n.item = b.value[t], n.currentItem = t, e("silentbox-overlay-prev-item-displayed", n.item);
    };
    return s({ openOverlay: y }), (t, I) => (openBlock(), createElementBlock("div", null, [
      renderSlot(t.$slots, "default"),
      (openBlock(true), createElementBlock(Fragment, null, renderList(unref(E), (m, k) => (openBlock(), createElementBlock("a", {
        key: m.src,
        href: m.src,
        onClick: withModifiers((l) => y(m, k), ["prevent"]),
        class: "silentbox-item"
      }, [
        renderSlot(t.$slots, "silentbox-item", { silentboxItem: m }, () => [
          createBaseVNode("img", {
            loading: o.lazyLoading ? "lazy" : "eager",
            src: m.thumbnail,
            alt: m.alt,
            width: m.thumbnailWidth,
            height: m.thumbnailHeight
          }, null, 8, he)
        ])
      ], 8, ye))), 128)),
      createVNode(N, {
        visible: n.visible,
        item: n.item,
        "current-item": n.currentItem,
        "total-items": unref(c),
        onSilentboxInternalCloseOverlay: h,
        onSilentboxInternalGetNextItem: x,
        onSilentboxInternalGetPrevItem: _
      }, null, 8, ["visible", "item", "current-item", "total-items"])
    ]));
  }
});
var fe = {
  install: (o, s = {}) => {
    o.component("silent-box", xe), o.provide("silent-box-options", {
      downloadButtonLabel: "Download",
      ...s
    }), o.config.globalProperties.$silentbox = {
      open: (e) => {
        const i = document.createElement("div");
        i.setAttribute("id", "silentbox--false-root");
        const c = createApp(N, {
          item: e,
          currentItem: 1,
          totalItems: 1,
          visible: true,
          onSilentboxInternalCloseOverlay: () => {
            n.$emit("silentbox-overlay-hidden", e), c.unmount(), i.remove();
          }
        }), n = c.mount(i);
        n.$emit("silentbox-overlay-opened", e), n.$forceUpdate(), document.body.appendChild(n.$el);
      }
    };
  }
};
export {
  fe as default
};
//# sourceMappingURL=vue-silentbox.js.map
